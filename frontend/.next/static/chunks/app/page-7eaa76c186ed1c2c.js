(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{398:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>em});var t=a(3365),r=a(1521),i=a(8600),n=a(6170);function l(e){let{currentData:s,totalData:a,unit:r}=e,i=s/a*100,n=2*Math.PI*45,l=n-i/100*n;return(0,t.jsxs)("div",{className:"relative w-48 h-48 mx-auto",children:[(0,t.jsxs)("svg",{className:"w-full h-full transform -rotate-90",viewBox:"0 0 100 100",children:[(0,t.jsx)("circle",{cx:"50",cy:"50",r:"45",stroke:"currentColor",strokeWidth:"8",fill:"none",className:"text-muted opacity-20"}),(0,t.jsx)("circle",{cx:"50",cy:"50",r:"45",stroke:"currentColor",strokeWidth:"8",fill:"none",strokeLinecap:"round",strokeDasharray:n,strokeDashoffset:l,className:"text-primary transition-all duration-1000 ease-out",style:{filter:"drop-shadow(0 0 8px #00CFE8)"}})]}),(0,t.jsxs)("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[(0,t.jsx)("div",{className:"text-3xl font-bold text-foreground",children:s.toFixed(1)}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:["of ",a," ",r]}),(0,t.jsxs)("div",{className:"text-xs text-primary mt-1",children:[i.toFixed(0),"% used"]})]})]})}var d=a(7265),c=a(1181),o=a(2934),m=a(9671);let u=(0,o.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground border-border"}},defaultVariants:{variant:"default"}});function x(e){let{className:s,variant:a,...r}=e;return(0,t.jsx)("div",{className:(0,m.cn)(u({variant:a}),s),...r})}function h(e){let{isConnected:s,networkName:a}=e;return(0,t.jsxs)("div",{className:"flex items-center gap-2 p-3 rounded-lg bg-card border",children:[s?(0,t.jsx)(d.A,{className:"w-5 h-5 text-primary"}):(0,t.jsx)(c.A,{className:"w-5 h-5 text-muted-foreground"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"text-sm font-medium",children:s?"Connected to WiFi":"No WiFi Connection"}),a&&(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:a})]}),(0,t.jsx)(x,{variant:s?"default":"secondary",children:s?"Online":"Offline"})]})}function f(e){let{icon:s,label:a,description:r,onClick:n,disabled:l=!1,variant:d="default"}=e;return(0,t.jsxs)(i.$,{onClick:n,disabled:l,variant:"outline",className:"w-full h-auto p-4 flex flex-col items-center gap-2 text-left bg-card border-border text-foreground hover:bg-muted/50 transition-colors",children:[(0,t.jsx)(s,{className:"w-8 h-8"}),(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("div",{className:"font-semibold",children:a}),(0,t.jsx)("div",{className:"text-xs opacity-80",children:r})]})]})}var g=a(2990),p=a(940);function j(e){let{size:s,date:a,used:r,status:i}=e;return(0,t.jsx)(n.Zp,{className:"p-3",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(p.A,{className:"w-4 h-4 text-primary"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-sm font-medium",children:s}),(0,t.jsxs)("div",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[(0,t.jsx)(g.A,{className:"w-3 h-3"}),a]})]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("div",{className:"text-xs text-muted-foreground",children:["Used: ",r]}),(0,t.jsx)("div",{className:"text-xs capitalize ".concat({completed:"text-muted-foreground",active:"text-primary",expired:"text-destructive"}[i]),children:i})]})]})})}var b=a(447),w=a(5842),N=a(2196);function v(e){let{type:s,title:a,message:n,isVisible:l,onClose:c,autoClose:o=!0,duration:m=3e3}=e;return((0,r.useEffect)(()=>{if(l&&o){let e=setTimeout(()=>{c()},m);return()=>clearTimeout(e)}},[l,o,m,c]),l)?(0,t.jsx)("div",{className:"fixed top-4 left-4 right-4 z-50 animate-in slide-in-from-top-2",children:(0,t.jsx)("div",{className:"p-4 rounded-lg border backdrop-blur-sm ".concat((()=>{switch(s){case"success":return"bg-green-900/20 border-green-500/30";case"warning":return"bg-yellow-900/20 border-yellow-500/30";case"info":return"bg-blue-900/20 border-blue-500/30"}})()),children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(()=>{switch(s){case"success":return(0,t.jsx)(w.A,{className:"w-5 h-5 text-green-400"});case"warning":return(0,t.jsx)(b.A,{className:"w-5 h-5 text-yellow-400"});case"info":return(0,t.jsx)(d.A,{className:"w-5 h-5 text-blue-400"})}})(),(0,t.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-foreground",children:a}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:n})]}),(0,t.jsx)(i.$,{variant:"ghost",size:"sm",onClick:c,className:"h-6 w-6 p-0",children:(0,t.jsx)(N.A,{className:"w-3 h-3"})})]})})}):null}var y=a(1e3),k=a(9491);function S(e){let{onSelect:s,onCancel:a}=e,[l,d]=(0,r.useState)(null);return(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:(0,t.jsxs)("div",{className:"w-full max-w-sm bg-background rounded-lg p-6 space-y-6",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("h2",{className:"text-xl font-semibold text-foreground",children:"Buy Data Credits"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Buy data credits to use later with eSIM"})]}),(0,t.jsx)("div",{className:"space-y-3",children:[{size:"1GB",price:"₦500",price_ngn:500,validity:"30 days"},{size:"5GB",price:"₦2,000",price_ngn:2e3,validity:"30 days",popular:!0},{size:"10GB",price:"₦3,500",price_ngn:3500,validity:"30 days"},{size:"20GB",price:"₦6,000",price_ngn:6e3,validity:"30 days"},{size:"Unlimited",price:"₦800",price_ngn:800,validity:"7 days",isUnlimited:!0,plan_type:"unlimited",popular:!0}].map(e=>(0,t.jsxs)(n.Zp,{className:"p-4 cursor-pointer transition-all relative ".concat((null==l?void 0:l.size)===e.size?"border-primary bg-primary/5":"border-border hover:border-primary/50"),onClick:()=>d(e),children:[e.popular&&(0,t.jsx)("div",{className:"absolute -top-2 left-4 bg-primary text-primary-foreground text-xs px-2 py-1 rounded",children:"Popular"}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"font-medium text-foreground",children:[e.size,e.isUnlimited&&(0,t.jsx)("span",{className:"ml-2 text-xs bg-primary text-primary-foreground px-2 py-1 rounded",children:"UNLIMITED"})]}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:[e.price," • Valid for ",e.validity]})]}),(null==l?void 0:l.size)===e.size&&(0,t.jsx)(y.A,{className:"w-5 h-5 text-primary"})]})]},e.size))}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)(i.$,{variant:"outline",onClick:a,className:"flex-1 bg-transparent",children:"Cancel"}),(0,t.jsxs)(i.$,{onClick:()=>l&&s(l),disabled:!l,className:"flex-1 bg-primary text-primary-foreground hover:bg-primary/90",children:[(0,t.jsx)(k.A,{className:"w-4 h-4 mr-2"}),"Buy Credits"]})]})]})})}var _=a(1172);let A=r.forwardRef((e,s)=>{let{className:a,value:r,...i}=e;return(0,t.jsx)(_.bL,{ref:s,className:(0,m.cn)("relative h-2 w-full overflow-hidden rounded-full bg-secondary",a),...i,children:(0,t.jsx)(_.C1,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(r||0),"%)")}})})});A.displayName=_.bL.displayName;var C=a(8299);let R=a(4089).env.NEXT_PUBLIC_BACKEND_URL||"https://your-backend-url.com";class B{async getCurrentUserId(){let{data:{session:e},error:s}=await C.N.auth.getSession();if(s)throw s;if(!(null==e?void 0:e.user))throw Error("No user logged in");return e.user.id}async getAuthToken(){let{data:{session:e},error:s}=await C.N.auth.getSession();if(s)throw s;if(!(null==e?void 0:e.access_token))throw Error("No auth token available");return e.access_token}async makeBackendRequest(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{let a=await this.getAuthToken(),t=await fetch("".concat(R,"/api").concat(e),{...s,headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a),...s.headers}});if(!t.ok){let e=await t.json().catch(()=>({}));throw Error(e.detail||"HTTP ".concat(t.status,": ").concat(t.statusText))}return await t.json()}catch(e){throw e}}async signup(e){var s,a,t;let{data:r,error:i}=await C.N.auth.signUp({email:e.email,password:e.password,options:{data:{first_name:e.first_name,last_name:e.last_name,phone_number:e.phone_number}}});if(i)throw i;if(r.user){let{error:s}=await C.N.from("users").insert({id:r.user.id,email:e.email,first_name:e.first_name,last_name:e.last_name,phone_number:e.phone_number,status:"active",is_admin:!1});if(s)throw s;try{await fetch("".concat(R,"/api/auth/webhook/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:r.user.id})})}catch(e){}}return{access_token:(null===(s=r.session)||void 0===s?void 0:s.access_token)||"",token_type:"bearer",expires_in:(null===(a=r.session)||void 0===a?void 0:a.expires_in)||3600,user:{id:(null===(t=r.user)||void 0===t?void 0:t.id)||"",email:e.email,first_name:e.first_name,last_name:e.last_name,phone_number:e.phone_number,status:"active",is_admin:!1,created_at:new Date().toISOString()}}}async login(e,s){var a,t,r;let{data:i,error:n}=await C.N.auth.signInWithPassword({email:e,password:s});if(n)throw n;if(i.user)try{await fetch("".concat(R,"/api/auth/webhook/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:i.user.id})})}catch(e){}let{data:l,error:d}=await C.N.from("users").select("*").eq("id",null===(a=i.user)||void 0===a?void 0:a.id).single();if(d)throw d;return{access_token:(null===(t=i.session)||void 0===t?void 0:t.access_token)||"",token_type:"bearer",expires_in:(null===(r=i.session)||void 0===r?void 0:r.expires_in)||3600,user:l}}async logout(){let{error:e}=await C.N.auth.signOut();if(e)throw e}async getCurrentUser(){let{data:{session:e},error:s}=await C.N.auth.getSession();if(s)throw s;if(!(null==e?void 0:e.user))throw Error("No user logged in");let{data:a,error:t}=await C.N.from("users").select("*").eq("id",e.user.id).single();if(t)throw t;return a}async refreshToken(){var e,s,a;let{data:t,error:r}=await C.N.auth.refreshSession();if(r)throw r;let{data:i,error:n}=await C.N.from("users").select("*").eq("id",null===(e=t.user)||void 0===e?void 0:e.id).single();if(n)throw n;return{access_token:(null===(s=t.session)||void 0===s?void 0:s.access_token)||"",token_type:"bearer",expires_in:(null===(a=t.session)||void 0===a?void 0:a.expires_in)||3600,user:i}}async getAvailableSessions(){return await this.makeBackendRequest("/sessions/available")}async startSessionDownload(e,s){return await this.makeBackendRequest("/sessions/download",{method:"POST",body:JSON.stringify({session_id:e,esim_id:s})})}async activateSession(e){return await this.makeBackendRequest("/sessions/activate",{method:"POST",body:JSON.stringify({session_id:e})})}async getMySessions(){return await this.makeBackendRequest("/sessions/my-sessions")}async getSessionStatus(e){return await this.makeBackendRequest("/sessions/".concat(e,"/status"))}async trackSessionUsage(e,s){return await this.makeBackendRequest("/sessions/track-usage",{method:"POST",body:JSON.stringify({session_id:e,data_used_mb:s})})}async getFreeQuotaUsage(){return await this.makeBackendRequest("/sessions/quota/free")}async getDataPacks(e){let s=await this.getCurrentUserId();return(await this.makeBackendRequest("/bundles/user/".concat(s,"/packs").concat(e?"?status=".concat(e):""))).packs}async getAvailableBundles(){return await this.makeBackendRequest("/bundles/available")}async calculateBundlePrice(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:30;return await this.makeBackendRequest("/bundles/calculate-price?data_mb=".concat(e,"&validity_days=").concat(s),{method:"POST"})}async createDataPack(e){let s=await this.getCurrentUserId();return await this.makeBackendRequest("/bundles/create",{method:"POST",body:JSON.stringify({user_id:s,...e})})}async recordDataUsage(e){let s=await this.getCurrentUserId();return await this.makeBackendRequest("/bundles/usage/update",{method:"POST",body:JSON.stringify({user_id:s,...e})})}async getDataPackStats(){let e=await this.getCurrentUserId();return await this.makeBackendRequest("/bundles/user/".concat(e,"/summary"))}async getESIMs(){let e=await this.getCurrentUserId();return(await this.makeBackendRequest("/esim/user/".concat(e))).esims}async provisionESIM(e){let s=await this.getCurrentUserId();return await this.makeBackendRequest("/esim/provision",{method:"POST",body:JSON.stringify({user_id:s,bundle_size_mb:e})})}async getESIMQRCode(e){return await this.makeBackendRequest("/esim/".concat(e,"/qr-code"))}async activateESIM(e){return await this.makeBackendRequest("/esim/".concat(e,"/activate"),{method:"POST"})}async suspendESIM(e){return await this.makeBackendRequest("/esim/".concat(e,"/suspend"),{method:"POST"})}async getESIMUsage(e){return await this.makeBackendRequest("/esim/".concat(e,"/usage"))}async getESIMStatus(e){return await this.makeBackendRequest("/esim/".concat(e,"/status"))}async getNotifications(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=await this.getCurrentUserId();return await this.makeBackendRequest("/notifications/user/".concat(a,"?limit=").concat(e,"&unread_only=").concat(s))}async markNotificationRead(e){let s=await this.getCurrentUserId();return await this.makeBackendRequest("/notifications/mark-read",{method:"POST",body:JSON.stringify({notification_id:e,user_id:s})})}async markAllNotificationsRead(){let e=await this.getCurrentUserId();return await this.makeBackendRequest("/notifications/user/".concat(e,"/mark-all-read"),{method:"POST"})}async getUnreadNotificationCount(){let e=await this.getCurrentUserId();return await this.makeBackendRequest("/notifications/user/".concat(e,"/unread-count"))}async registerDevice(e,s){let a=await this.getCurrentUserId();return await this.makeBackendRequest("/auth/device/register",{method:"POST",body:JSON.stringify({user_id:a,push_token:e,device_type:s})})}async getMonitoringStats(){return await this.makeBackendRequest("/monitoring/stats")}async healthCheck(){try{let e=await C.N.from("users").select("id").limit(1),s=await this.makeBackendRequest("/monitoring/health");return{status:"healthy",service:"KSWiFi App (Hybrid)",supabase:e.error?"unhealthy":"healthy",backend:s.status||"healthy"}}catch(e){return{status:"unhealthy",service:"KSWiFi App (Hybrid)",error:e instanceof Error?e.message:"Unknown error"}}}}let I=new B;var P=a(1971),F=a(150),D=a(6414),E=a(8626),q=a(2393),z=a(2259),M=a(7832),W=a(5655);function T(e){let{onSessionDownload:s}=e,[a,l]=(0,r.useState)([]),[c,o]=(0,r.useState)(null),[m,u]=(0,r.useState)(!1),[h,f]=(0,r.useState)(0),[g,p]=(0,r.useState)(null),[j,b]=(0,r.useState)(null),[N,v]=(0,r.useState)(!0);(0,r.useEffect)(()=>{y(),S()},[]);let y=async()=>{try{let e=await I.getAvailableSessions();l(e)}catch(e){P.oR.error("Failed to load available sessions")}finally{v(!1)}},S=async()=>{try{let e=await I.getFreeQuotaUsage();b(e.data)}catch(e){}},_=async e=>{if(!m)try{u(!0),p(e),f(0);let a=await I.startSessionDownload(e);if(a.success)P.oR.success("Session download started!"),s(e),C(a.data.session_id);else throw Error(a.message||"Download failed")}catch(e){P.oR.error(e.message||"Failed to start session download"),u(!1),p(null)}},C=e=>{let s=0,a=setInterval(async()=>{if((s+=15*Math.random()+5)>=100){s=100,clearInterval(a),u(!1),p(null),f(0);try{let s=await I.getSessionStatus(e);"stored"===s.data.status&&P.oR.success("Internet session downloaded successfully!",{description:"You can now activate it for offline use"})}catch(e){}}else f(s)},800)},R=e=>e.is_free?(0,t.jsx)(E.A,{className:"h-5 w-5 text-green-500"}):e.is_unlimited?(0,t.jsx)(W.A,{className:"h-5 w-5 text-kswifi-cyan"}):(0,t.jsx)(k.A,{className:"h-5 w-5 text-blue-500"}),B=e=>e.is_free?"FREE":"₦".concat(e.price_ngn.toLocaleString()),T=e=>7===e?"1 week":30===e?"1 month":"".concat(e," days");return N?(0,t.jsxs)(n.Zp,{className:"w-full max-w-4xl mx-auto bg-card border border-border",children:[(0,t.jsx)(n.aR,{className:"text-center",children:(0,t.jsxs)("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[(0,t.jsx)(d.A,{className:"h-6 w-6 text-kswifi-cyan animate-pulse"}),(0,t.jsx)(n.ZB,{className:"text-xl font-semibold text-foreground",children:"Loading Sessions..."})]})}),(0,t.jsx)(n.Wu,{children:(0,t.jsx)("div",{className:"space-y-4",children:[1,2,3].map(e=>(0,t.jsx)("div",{className:"h-24 bg-muted animate-pulse rounded-lg"},e))})})]}):(0,t.jsxs)(n.Zp,{className:"w-full max-w-4xl mx-auto bg-card border border-border",children:[(0,t.jsxs)(n.aR,{className:"text-center",children:[(0,t.jsxs)("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[(0,t.jsx)(d.A,{className:"h-6 w-6 text-kswifi-cyan"}),(0,t.jsx)(n.ZB,{className:"text-xl font-semibold text-foreground",children:"Download Internet Sessions"})]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Download internet sessions on WiFi to use later offline via eSIM"}),j&&(0,t.jsxs)("div",{className:"mt-4 p-3 bg-muted rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-muted-foreground",children:"Free Quota This Month"}),(0,t.jsxs)("span",{className:"font-medium text-foreground",children:[(j.used_mb/1024).toFixed(1),"GB / ",(j.limit_mb/1024).toFixed(0),"GB"]})]}),(0,t.jsx)(A,{value:j.percentage_used,className:"mt-2 h-2"})]})]}),(0,t.jsxs)(n.Wu,{children:[m&&(0,t.jsxs)("div",{className:"mb-6 p-4 bg-kswifi-cyan/10 border border-kswifi-cyan/20 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[(0,t.jsx)(k.A,{className:"h-5 w-5 text-kswifi-cyan animate-bounce"}),(0,t.jsx)("span",{className:"font-medium text-foreground",children:"Downloading Internet Session..."})]}),(0,t.jsx)(A,{value:h,className:"h-3 mb-2"}),(0,t.jsxs)("div",{className:"flex justify-between text-xs text-muted-foreground",children:[(0,t.jsx)("span",{children:"Transferring to eSIM storage"}),(0,t.jsxs)("span",{children:[Math.round(h),"% complete"]})]})]}),(0,t.jsx)("div",{className:"space-y-4",children:a.map(e=>(0,t.jsx)(n.Zp,{className:"transition-all duration-200 hover:shadow-md border ".concat(e.is_free?"border-green-500/30 bg-green-500/5":e.is_unlimited?"border-kswifi-cyan/30 bg-kswifi-cyan/5":"border-border bg-card"),children:(0,t.jsx)(n.Wu,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,t.jsxs)("div",{className:"flex items-start space-x-4 flex-1",children:[(0,t.jsx)("div",{className:"flex-shrink-0 mt-1",children:R(e)}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,t.jsx)("h3",{className:"font-semibold text-foreground text-lg",children:e.size}),e.is_free&&(0,t.jsx)(x,{variant:"secondary",className:"bg-green-500/20 text-green-700 dark:text-green-300",children:"FREE"}),e.is_unlimited&&(0,t.jsxs)(x,{variant:"secondary",className:"bg-kswifi-cyan/20 text-kswifi-cyan",children:[(0,t.jsx)(M.A,{className:"h-3 w-3 mr-1"}),"UNLIMITED"]})]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-3",children:e.description}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2 mb-3",children:e.features.slice(0,3).map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center space-x-1 text-xs text-muted-foreground",children:[(0,t.jsx)(w.A,{className:"h-3 w-3 text-kswifi-cyan"}),(0,t.jsx)("span",{children:e})]},s))}),(0,t.jsxs)("div",{className:"flex items-center space-x-4 text-xs text-muted-foreground",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,t.jsx)(D.A,{className:"h-3 w-3"}),(0,t.jsxs)("span",{children:["Valid ",T(e.validity_days)]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,t.jsx)(z.A,{className:"h-3 w-3"}),(0,t.jsx)("span",{children:"Activate via eSIM"})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,t.jsx)(q.A,{className:"h-3 w-3"}),(0,t.jsx)("span",{children:"Offline capable"})]})]})]})]}),(0,t.jsxs)("div",{className:"flex sm:flex-col items-center sm:items-end justify-between sm:justify-start sm:space-y-3 w-full sm:w-auto",children:[(0,t.jsxs)("div",{className:"text-left sm:text-right",children:[(0,t.jsx)("div",{className:"text-xl sm:text-2xl font-bold text-foreground",children:B(e)}),!e.is_free&&(0,t.jsxs)("div",{className:"text-xs text-muted-foreground",children:["per ",T(e.validity_days)]})]}),(0,t.jsx)(i.$,{onClick:()=>_(e.id),disabled:m||g===e.id,className:"".concat((e.is_free||e.is_unlimited,"bg-primary hover:bg-primary/90 text-primary-foreground")," transition-all duration-200 font-medium min-w-[120px] sm:min-w-[140px]"),size:"sm",children:g===e.id?(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(k.A,{className:"h-4 w-4 animate-spin"}),(0,t.jsx)("span",{children:"Downloading"})]}):(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(k.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Download"}),(0,t.jsx)(F.A,{className:"h-3 w-3"})]})})]})]})})},e.id))}),(0,t.jsx)("div",{className:"mt-6 p-4 bg-muted rounded-lg",children:(0,t.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,t.jsx)("div",{className:"flex-shrink-0 mt-0.5",children:(0,t.jsx)("div",{className:"w-2 h-2 bg-kswifi-cyan rounded-full"})}),(0,t.jsxs)("div",{className:"text-sm text-muted-foreground",children:[(0,t.jsx)("p",{className:"font-medium text-foreground mb-1",children:"How it works:"}),(0,t.jsxs)("p",{children:["1. Connect to WiFi and download an internet session",(0,t.jsx)("br",{}),"2. Session is stored on your phone's eSIM chip",(0,t.jsx)("br",{}),"3. When offline, activate the eSIM to use your downloaded session",(0,t.jsx)("br",{}),"4. Browse normally until the session is finished"]})]})]})})]})]})}var O=a(6713),U=a(9703),$=a(3966),Z=a(231),L=a(1892),J=a(3309);function G(e){let{refreshTrigger:s=0}=e,[a,l]=(0,r.useState)([]),[d,o]=(0,r.useState)(!0),[m,u]=(0,r.useState)(null);(0,r.useEffect)(()=>{h()},[s]);let h=async()=>{try{o(!0);let e=await I.getMySessions();l(e)}catch(e){P.oR.error("Failed to load your sessions")}finally{o(!1)}},f=async e=>{if(!m)try{u(e);let s=await I.activateSession(e);if(s.success)P.oR.success("Session activated successfully!",{description:"Your internet session is now active"}),await h();else throw Error(s.message||"Activation failed")}catch(e){P.oR.error(e.message||"Failed to activate session")}finally{u(null)}},g=e=>{switch(e){case"downloading":return(0,t.jsx)(k.A,{className:"h-4 w-4 text-blue-500 animate-bounce"});case"transferring":return(0,t.jsx)(L.A,{className:"h-4 w-4 text-kswifi-cyan animate-spin"});case"stored":return(0,t.jsx)(w.A,{className:"h-4 w-4 text-green-500"});case"active":return(0,t.jsx)(O.A,{className:"h-4 w-4 text-kswifi-cyan animate-pulse"});case"exhausted":return(0,t.jsx)(U.A,{className:"h-4 w-4 text-red-500"});default:return(0,t.jsx)(D.A,{className:"h-4 w-4 text-gray-500"})}},p=e=>{switch(e){case"downloading":return"Downloading";case"transferring":return"Transferring to eSIM";case"stored":return"Ready to activate";case"active":return"Active";case"exhausted":return"Session finished";case"expired":return"Expired";default:return e}},j=e=>{switch(e){case"active":return"default";case"stored":return"secondary";case"exhausted":case"expired":return"destructive";default:return"outline"}},b=e=>e>=999999?"Unlimited":e>=1024?"".concat((e/1024).toFixed(1),"GB"):"".concat(e,"MB"),N=e=>{let s=new Date(e),a=Math.floor((new Date().getTime()-s.getTime())/36e5);if(a<1)return"Just now";if(a<24)return"".concat(a,"h ago");let t=Math.floor(a/24);return"".concat(t,"d ago")},v=e=>{let s=new Date(e),a=new Date,t=Math.floor((s.getTime()-a.getTime())/36e5);if(t<0)return"Expired";if(t<24)return"".concat(t,"h left");let r=Math.floor(t/24);return"".concat(r,"d left")};return d?(0,t.jsxs)(n.Zp,{className:"w-full max-w-4xl mx-auto bg-card border border-border",children:[(0,t.jsx)(n.aR,{children:(0,t.jsxs)(n.ZB,{className:"flex items-center space-x-2",children:[(0,t.jsx)(z.A,{className:"h-5 w-5 text-kswifi-cyan"}),(0,t.jsx)("span",{children:"My Internet Sessions"})]})}),(0,t.jsx)(n.Wu,{children:(0,t.jsx)("div",{className:"space-y-4",children:[1,2,3].map(e=>(0,t.jsx)("div",{className:"h-20 bg-muted animate-pulse rounded-lg"},e))})})]}):0===a.length?(0,t.jsxs)(n.Zp,{className:"w-full max-w-4xl mx-auto bg-card border border-border",children:[(0,t.jsx)(n.aR,{children:(0,t.jsxs)(n.ZB,{className:"flex items-center space-x-2",children:[(0,t.jsx)(z.A,{className:"h-5 w-5 text-kswifi-cyan"}),(0,t.jsx)("span",{children:"My Internet Sessions"})]})}),(0,t.jsx)(n.Wu,{children:(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(c.A,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-medium text-foreground mb-2",children:"No sessions yet"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Download your first internet session to get started"})]})})]}):(0,t.jsxs)(n.Zp,{className:"w-full max-w-4xl mx-auto bg-card border border-border",children:[(0,t.jsx)(n.aR,{children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)(n.ZB,{className:"flex items-center space-x-2",children:[(0,t.jsx)(z.A,{className:"h-5 w-5 text-kswifi-cyan"}),(0,t.jsx)("span",{children:"My Internet Sessions"})]}),(0,t.jsxs)(i.$,{variant:"outline",size:"sm",onClick:h,disabled:d,children:[(0,t.jsx)(L.A,{className:"h-4 w-4 mr-2 ".concat(d?"animate-spin":"")}),"Refresh"]})]})}),(0,t.jsxs)(n.Wu,{children:[(0,t.jsx)("div",{className:"space-y-4",children:a.map(e=>(0,t.jsx)(n.Zp,{className:"border border-border bg-muted/30",children:(0,t.jsx)(n.Wu,{className:"p-4",children:(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,t.jsxs)("div",{className:"flex items-start space-x-4 flex-1",children:[(0,t.jsx)("div",{className:"flex-shrink-0 mt-1",children:g(e.status)}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,t.jsx)("h3",{className:"font-semibold text-foreground",children:e.name}),(0,t.jsx)(x,{variant:j(e.status),children:p(e.status)}),e.size.includes("Unlimited")&&(0,t.jsxs)(x,{variant:"secondary",className:"bg-kswifi-cyan/20 text-kswifi-cyan",children:[(0,t.jsx)(W.A,{className:"h-3 w-3 mr-1"}),"UNLIMITED"]})]}),("downloading"===e.status||"transferring"===e.status)&&(0,t.jsxs)("div",{className:"mb-3",children:[(0,t.jsx)(A,{value:e.progress_percent,className:"h-2 mb-1"}),(0,t.jsxs)("div",{className:"flex justify-between text-xs text-muted-foreground",children:[(0,t.jsx)("span",{children:"downloading"===e.status?"Downloading session...":"Transferring to eSIM..."}),(0,t.jsxs)("span",{children:[e.progress_percent,"%"]})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-muted-foreground",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,t.jsx)(k.A,{className:"h-3 w-3"}),(0,t.jsxs)("span",{children:["Downloaded ",N(e.download_started_at)]})]}),e.is_active&&(0,t.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,t.jsx)(O.A,{className:"h-3 w-3 text-kswifi-cyan"}),(0,t.jsxs)("span",{children:[b(e.data_remaining_mb)," remaining"]})]}),e.expires_at&&(0,t.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,t.jsx)(J.A,{className:"h-3 w-3"}),(0,t.jsx)("span",{children:v(e.expires_at)})]})]})]})]}),(0,t.jsxs)("div",{className:"flex flex-row sm:flex-col gap-2 sm:space-y-2 justify-start sm:justify-end w-full sm:w-auto",children:[e.can_activate&&(0,t.jsx)(i.$,{onClick:()=>f(e.id),disabled:m===e.id,className:"bg-primary hover:bg-primary/90 text-primary-foreground font-medium min-w-[100px] flex-1 sm:flex-none",size:"sm",children:m===e.id?(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)(L.A,{className:"h-4 w-4 animate-spin"}),(0,t.jsx)("span",{children:"Activating"})]}):(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)($.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{children:"Activate"})]})}),e.is_active&&(0,t.jsxs)(i.$,{variant:"outline",size:"sm",className:"border-kswifi-cyan text-kswifi-cyan hover:bg-kswifi-cyan/10 flex-1 sm:flex-none",children:[(0,t.jsx)(Z.A,{className:"h-4 w-4 mr-2"}),"QR Code"]}),("exhausted"===e.status||"expired"===e.status)&&(0,t.jsxs)(i.$,{variant:"outline",size:"sm",disabled:!0,className:"opacity-50 flex-1 sm:flex-none",children:[(0,t.jsx)(U.A,{className:"h-4 w-4 mr-2"}),"exhausted"===e.status?"Finished":"Expired"]})]})]})})},e.id))}),a.some(e=>e.can_activate)&&(0,t.jsx)("div",{className:"mt-6 p-4 bg-kswifi-cyan/10 border border-kswifi-cyan/20 rounded-lg",children:(0,t.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,t.jsx)(Z.A,{className:"h-5 w-5 text-kswifi-cyan flex-shrink-0 mt-0.5"}),(0,t.jsxs)("div",{className:"text-sm text-foreground",children:[(0,t.jsx)("p",{className:"font-medium mb-1",children:"Ready to go offline?"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:'Click "Activate" to enable your downloaded session. You\'ll get a QR code to add the eSIM to your phone, then you can use the internet even without WiFi!'})]})]})})]})]})}var V=a(7812),Q=a(2770),K=a(4428),H=a(6309),Y=a(3505),X=a(3678);function ee(e){let{onSuccess:s,onSwitchToSignUp:a,onForgotPassword:l}=e,{signIn:d}=(0,K.A)(),[c,o]=(0,r.useState)({email:"",password:""}),[m,u]=(0,r.useState)(!1),[x,h]=(0,r.useState)(!1),[f,g]=(0,r.useState)(null),p=async e=>{e.preventDefault(),h(!0),g(null);try{let{data:e,error:a}=await d(c.email,c.password);if(a)throw a;(null==e?void 0:e.user)&&(null==s||s())}catch(e){g(e.message||"Failed to sign in. Please check your credentials.")}finally{h(!1)}},j=(e,s)=>{o(a=>({...a,[e]:s})),g(null)};return(0,t.jsxs)(n.Zp,{className:"w-full max-w-md mx-auto bg-card border-border",children:[(0,t.jsxs)(n.aR,{className:"text-center",children:[(0,t.jsx)(n.ZB,{className:"text-2xl font-bold text-foreground",children:"Welcome Back"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Sign in to your KSWiFi account"})]}),(0,t.jsxs)("form",{onSubmit:p,children:[(0,t.jsxs)(n.Wu,{className:"space-y-4",children:[f&&(0,t.jsx)("div",{className:"p-3 text-sm text-red-400 bg-red-900/20 border border-red-800 rounded-md",children:f}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(Q.J,{htmlFor:"email",className:"text-foreground",children:"Email"}),(0,t.jsx)(V.p,{id:"email",type:"email",placeholder:"Enter your email",value:c.email,onChange:e=>j("email",e.target.value),required:!0,disabled:x,className:"bg-input border-border text-foreground placeholder:text-muted-foreground focus:ring-primary"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(Q.J,{htmlFor:"password",className:"text-foreground",children:"Password"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(V.p,{id:"password",type:m?"text":"password",placeholder:"Enter your password",value:c.password,onChange:e=>j("password",e.target.value),required:!0,disabled:x,className:"pr-10 bg-input border-border text-foreground placeholder:text-muted-foreground focus:ring-primary"}),(0,t.jsx)(i.$,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-muted text-muted-foreground hover:text-foreground",onClick:()=>u(!m),disabled:x,children:m?(0,t.jsx)(Y.A,{className:"h-4 w-4"}):(0,t.jsx)(H.A,{className:"h-4 w-4"})})]})]}),(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsx)(i.$,{type:"button",variant:"link",size:"sm",onClick:l,disabled:x,className:"px-0 text-primary hover:text-primary/80",children:"Forgot password?"})})]}),(0,t.jsxs)(n.wL,{className:"flex flex-col space-y-4",children:[(0,t.jsx)(i.$,{type:"submit",className:"w-full bg-primary text-primary-foreground hover:bg-primary/90 focus:ring-primary",disabled:x||!c.email||!c.password,children:x?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(X.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Signing In..."]}):"Sign In"}),(0,t.jsxs)("div",{className:"text-center text-sm text-muted-foreground",children:["Don't have an account?"," ",(0,t.jsx)(i.$,{type:"button",variant:"link",size:"sm",onClick:a,disabled:x,className:"px-0 text-primary hover:text-primary/80",children:"Sign up"})]})]})]})]})}function es(e){let{onSuccess:s,onSwitchToSignIn:a}=e,{signUp:l}=(0,K.A)(),[d,c]=(0,r.useState)({first_name:"",last_name:"",email:"",phone_number:"",password:"",confirmPassword:""}),[o,m]=(0,r.useState)(!1),[u,x]=(0,r.useState)(!1),[h,f]=(0,r.useState)(!1),[g,p]=(0,r.useState)(null),j={length:d.password.length>=8,uppercase:/[A-Z]/.test(d.password),lowercase:/[a-z]/.test(d.password),number:/\d/.test(d.password),special:/[!@#$%^&*(),.?":{}|<>]/.test(d.password)},b=Object.values(j).every(Boolean),w=d.password===d.confirmPassword&&d.confirmPassword.length>0,v=async e=>{if(e.preventDefault(),f(!0),p(null),!b){p("Password does not meet requirements"),f(!1);return}if(!w){p("Passwords do not match"),f(!1);return}try{let{data:e,error:a}=await l(d.email,d.password,{first_name:d.first_name,last_name:d.last_name,phone_number:d.phone_number||void 0});if(a)throw a;(null==e?void 0:e.user)&&(null==s||s())}catch(e){p(e.message||"Failed to create account. Please try again.")}finally{f(!1)}},k=(e,s)=>{c(a=>({...a,[e]:s})),p(null)},S=e=>{let{met:s,text:a}=e;return(0,t.jsxs)("div",{className:"flex items-center text-xs ".concat(s?"text-primary":"text-muted-foreground"),children:[s?(0,t.jsx)(y.A,{className:"h-3 w-3 mr-1"}):(0,t.jsx)(N.A,{className:"h-3 w-3 mr-1"}),a]})};return(0,t.jsxs)(n.Zp,{className:"w-full max-w-md mx-auto bg-card border-border",children:[(0,t.jsxs)(n.aR,{className:"text-center",children:[(0,t.jsx)(n.ZB,{className:"text-2xl font-bold text-foreground",children:"Create Account"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Sign up for your KSWiFi account"})]}),(0,t.jsxs)("form",{onSubmit:v,children:[(0,t.jsxs)(n.Wu,{className:"space-y-4",children:[g&&(0,t.jsx)("div",{className:"p-3 text-sm text-red-400 bg-red-900/20 border border-red-800 rounded-md",children:g}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(Q.J,{htmlFor:"first_name",className:"text-foreground",children:"First Name"}),(0,t.jsx)(V.p,{id:"first_name",type:"text",placeholder:"First name",value:d.first_name,onChange:e=>k("first_name",e.target.value),required:!0,disabled:h,className:"bg-input border-border text-foreground placeholder:text-muted-foreground focus:ring-primary"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(Q.J,{htmlFor:"last_name",className:"text-foreground",children:"Last Name"}),(0,t.jsx)(V.p,{id:"last_name",type:"text",placeholder:"Last name",value:d.last_name,onChange:e=>k("last_name",e.target.value),required:!0,disabled:h,className:"bg-input border-border text-foreground placeholder:text-muted-foreground focus:ring-primary"})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(Q.J,{htmlFor:"email",className:"text-foreground",children:"Email"}),(0,t.jsx)(V.p,{id:"email",type:"email",placeholder:"Enter your email",value:d.email,onChange:e=>k("email",e.target.value),required:!0,disabled:h,className:"bg-input border-border text-foreground placeholder:text-muted-foreground focus:ring-primary"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(Q.J,{htmlFor:"phone_number",className:"text-foreground",children:"Phone Number (Optional)"}),(0,t.jsx)(V.p,{id:"phone_number",type:"tel",placeholder:"Enter your phone number",value:d.phone_number,onChange:e=>k("phone_number",e.target.value),disabled:h,className:"bg-input border-border text-foreground placeholder:text-muted-foreground focus:ring-primary"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(Q.J,{htmlFor:"password",className:"text-foreground",children:"Password"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(V.p,{id:"password",type:o?"text":"password",placeholder:"Create a password",value:d.password,onChange:e=>k("password",e.target.value),required:!0,disabled:h,className:"pr-10 bg-input border-border text-foreground placeholder:text-muted-foreground focus:ring-primary"}),(0,t.jsx)(i.$,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-muted text-muted-foreground hover:text-foreground",onClick:()=>m(!o),disabled:h,children:o?(0,t.jsx)(Y.A,{className:"h-4 w-4"}):(0,t.jsx)(H.A,{className:"h-4 w-4"})})]}),d.password&&(0,t.jsxs)("div",{className:"space-y-1 p-2 bg-muted/20 border border-border rounded",children:[(0,t.jsx)(S,{met:j.length,text:"At least 8 characters"}),(0,t.jsx)(S,{met:j.uppercase,text:"One uppercase letter"}),(0,t.jsx)(S,{met:j.lowercase,text:"One lowercase letter"}),(0,t.jsx)(S,{met:j.number,text:"One number"}),(0,t.jsx)(S,{met:j.special,text:"One special character"})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(Q.J,{htmlFor:"confirmPassword",className:"text-foreground",children:"Confirm Password"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(V.p,{id:"confirmPassword",type:u?"text":"password",placeholder:"Confirm your password",value:d.confirmPassword,onChange:e=>k("confirmPassword",e.target.value),required:!0,disabled:h,className:"pr-10 bg-input border-border text-foreground placeholder:text-muted-foreground focus:ring-primary"}),(0,t.jsx)(i.$,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>x(!u),disabled:h,children:u?(0,t.jsx)(Y.A,{className:"h-4 w-4"}):(0,t.jsx)(H.A,{className:"h-4 w-4"})})]}),d.confirmPassword&&(0,t.jsx)("div",{className:"text-xs ".concat(w?"text-primary":"text-red-400"),children:w?(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(y.A,{className:"h-3 w-3 mr-1"}),"Passwords match"]}):(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(N.A,{className:"h-3 w-3 mr-1"}),"Passwords do not match"]})})]})]}),(0,t.jsxs)(n.wL,{className:"flex flex-col space-y-4",children:[(0,t.jsx)(i.$,{type:"submit",className:"w-full bg-primary text-primary-foreground hover:bg-primary/90 focus:ring-primary",disabled:h||!b||!w||!d.first_name||!d.last_name||!d.email,children:h?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(X.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating Account..."]}):"Create Account"}),(0,t.jsxs)("div",{className:"text-center text-sm text-muted-foreground",children:["Already have an account?"," ",(0,t.jsx)(i.$,{type:"button",variant:"link",size:"sm",onClick:a,disabled:h,className:"px-0 text-primary hover:text-primary/80",children:"Sign in"})]})]})]})]})}var ea=a(1941);function et(e){let{onBack:s}=e,{resetPassword:a}=(0,K.A)(),[l,d]=(0,r.useState)(""),[c,o]=(0,r.useState)(!1),[m,u]=(0,r.useState)(null),[x,h]=(0,r.useState)(!1),f=async e=>{e.preventDefault(),o(!0),u(null);try{let{data:e,error:s}=await a(l);if(s)throw s;h(!0)}catch(e){u(e.message||"Failed to send reset email. Please try again.")}finally{o(!1)}};return x?(0,t.jsxs)(n.Zp,{className:"w-full max-w-md mx-auto bg-card border-border",children:[(0,t.jsxs)(n.aR,{className:"text-center",children:[(0,t.jsx)("div",{className:"mx-auto mb-4 flex h-12 w-12 items-center justify-center rounded-full bg-primary/20",children:(0,t.jsx)(w.A,{className:"h-6 w-6 text-primary"})}),(0,t.jsx)(n.ZB,{className:"text-2xl font-bold text-foreground",children:"Check Your Email"}),(0,t.jsxs)("p",{className:"text-muted-foreground",children:["We've sent a password reset link to ",(0,t.jsx)("strong",{children:l})]})]}),(0,t.jsx)(n.Wu,{className:"text-center text-sm text-muted-foreground",children:(0,t.jsx)("p",{children:"Click the link in the email to reset your password. If you don't see the email, check your spam folder."})}),(0,t.jsxs)(n.wL,{className:"flex flex-col space-y-4",children:[(0,t.jsx)(i.$,{variant:"outline",onClick:()=>{h(!1),d(""),u(null)},className:"w-full border-border text-foreground hover:bg-muted",children:"Send Another Email"}),(0,t.jsxs)(i.$,{variant:"link",onClick:s,className:"w-full text-muted-foreground hover:text-foreground",children:[(0,t.jsx)(ea.A,{className:"mr-2 h-4 w-4"}),"Back to Sign In"]})]})]}):(0,t.jsxs)(n.Zp,{className:"w-full max-w-md mx-auto bg-card border-border",children:[(0,t.jsxs)(n.aR,{className:"text-center",children:[(0,t.jsx)(n.ZB,{className:"text-2xl font-bold text-foreground",children:"Reset Password"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Enter your email address and we'll send you a link to reset your password"})]}),(0,t.jsxs)("form",{onSubmit:f,children:[(0,t.jsxs)(n.Wu,{className:"space-y-4",children:[m&&(0,t.jsx)("div",{className:"p-3 text-sm text-red-400 bg-red-900/20 border border-red-800 rounded-md",children:m}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(Q.J,{htmlFor:"email",className:"text-foreground",children:"Email Address"}),(0,t.jsx)(V.p,{id:"email",type:"email",placeholder:"Enter your email address",value:l,onChange:e=>{d(e.target.value),u(null)},required:!0,disabled:c,className:"bg-input border-border text-foreground placeholder:text-muted-foreground focus:ring-primary"})]})]}),(0,t.jsxs)(n.wL,{className:"flex flex-col space-y-4",children:[(0,t.jsx)(i.$,{type:"submit",className:"w-full bg-primary text-primary-foreground hover:bg-primary/90 focus:ring-primary",disabled:c||!l,children:c?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(X.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Sending Reset Link..."]}):"Send Reset Link"}),(0,t.jsxs)(i.$,{type:"button",variant:"link",onClick:s,disabled:c,className:"w-full text-muted-foreground hover:text-foreground",children:[(0,t.jsx)(ea.A,{className:"mr-2 h-4 w-4"}),"Back to Sign In"]})]})]})]})}function er(e){let{children:s,fallback:a}=e,{user:r,loading:i}=(0,K.A)();return i?(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(X.A,{className:"h-8 w-8 animate-spin mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Loading..."})]})}):r?(0,t.jsx)(t.Fragment,{children:s}):a||null}a(6333);var ei=a(8416),en=a(1360),el=a(6712),ed=a(1647),ec=a(3697),eo=a(7931);function em(){let{user:e,loading:s,signOut:a}=(0,K.A)(),{profile:d,loading:c}=function(){let{user:e,session:s}=(0,K.A)(),[a,t]=(0,r.useState)(null),[i,n]=(0,r.useState)(!0),[l,d]=(0,r.useState)(null);(0,r.useEffect)(()=>{e?c():(t(null),n(!1))},[e]);let c=async()=>{try{n(!0),d(null);let{data:s,error:a}=await C.N.from("users").select("*").eq("id",null==e?void 0:e.id).single();if(a)throw a;t(s)}catch(e){d(e.message)}finally{n(!1)}};return{profile:a,loading:i,error:l,updateProfile:async s=>{try{d(null);let{data:a,error:r}=await C.N.from("users").update(s).eq("id",null==e?void 0:e.id).select().single();if(r)throw r;return t(a),{data:a,error:null}}catch(e){return d(e.message),{data:null,error:e}}},refreshProfile:c}}(),[o,m]=(0,r.useState)("onboarding"),[u,x]=(0,r.useState)("signin"),[g,p]=(0,r.useState)(!1),[b,w]=(0,r.useState)({type:"info",title:"",message:"",isVisible:!1}),[N,y]=(0,r.useState)(!1),[_,A]=(0,r.useState)([]),[R,B]=(0,r.useState)([]),[F,D]=(0,r.useState)(null),[E,M]=(0,r.useState)(!1),[W,O]=(0,r.useState)(0);(0,r.useEffect)(()=>{let e=new URLSearchParams(window.location.search),s=e.get("message"),a=e.get("error");if("password_updated"===s)P.oR.success("Password updated successfully!"),window.history.replaceState({},"",window.location.pathname);else if(a){switch(a){case"invalid_reset_link":P.oR.error("Invalid or expired reset link");break;case"reset_error":P.oR.error("An error occurred during password reset");break;default:P.oR.error("An error occurred")}window.history.replaceState({},"",window.location.pathname)}},[]),(0,r.useEffect)(()=>{s||(e?(m("dashboard"),U()):m("onboarding"))},[e,s]);let U=async()=>{if(e)try{let e=await I.getDataPacks();A(e);let s=await I.getESIMs();B(s);let a=await I.getDataPackStats();D(a)}catch(e){P.oR.error("Failed to load user data")}},L=d?{name:"".concat(d.first_name," ").concat(d.last_name),email:d.email,currentData:(null==F?void 0:F.used_data_mb)||0,totalData:(null==F?void 0:F.total_data_mb)||0,isWifiConnected:!0,networkName:"WiFi Network"}:{name:"Guest User",email:"",currentData:0,totalData:0,isWifiConnected:!0,networkName:"WiFi Network"},J=_.length>0?_.map(e=>({size:e.name,date:new Date(e.created_at).toLocaleDateString(),used:"".concat(e.used_data_mb,"MB"),status:e.status})):[{size:"No data packs",date:"Sign in to view",used:"0 GB",status:"completed"}],V=(e,s,a)=>{w({type:e,title:s,message:a,isVisible:!0})},Q=async()=>{try{await a(),m("onboarding"),A([]),B([]),D(null),P.oR.success("Signed out successfully")}catch(e){P.oR.error("Error signing out")}},H=async()=>{if(!e){V("warning","Sign In Required","Please sign in to activate data packs");return}try{let e=(await I.getMySessions()).filter(e=>e.can_activate);if(0===e.length){V("info","No Data Packs Available","Download a session first, then activate it here");return}if(1===e.length){let s=e[0];await I.activateSession(s.id),O(e=>e+1),V("success","Data Pack Activated!","".concat(s.size," session is now active"))}else V("info","Multiple Sessions Available","Check 'My Sessions' below to choose which one to activate")}catch(e){V("warning","Activation Failed",e.message||"Failed to activate data pack")}},Y=async s=>{if(p(!1),!e){V("warning","Authentication Required","Please sign in first");return}try{await I.createDataPack({bundle_name:s.size,validity_days:30}),V("success","Data Credits Purchased!","".concat(s.size," credits added to your account")),await U()}catch(e){V("warning","Purchase Failed",e.message||"Failed to purchase data credits")}},X=()=>{m("dashboard"),P.oR.success("Welcome ".concat((null==d?void 0:d.first_name)||"back","!"))},ea=()=>(0,t.jsxs)("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:[(0,t.jsx)("div",{className:"absolute top-4 left-4",children:(0,t.jsx)(i.$,{variant:"ghost",size:"sm",onClick:()=>{x("signin"),m("onboarding")},className:"text-muted-foreground hover:text-foreground",children:"← Back"})}),"signin"===u&&(0,t.jsx)(ee,{onSuccess:X,onSwitchToSignUp:()=>x("signup"),onForgotPassword:()=>x("reset-password")}),"signup"===u&&(0,t.jsx)(es,{onSuccess:X,onSwitchToSignIn:()=>x("signin")}),"reset-password"===u&&(0,t.jsx)(et,{onBack:()=>x("signin")})]});return s?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Loading..."})]})}):e?(0,t.jsxs)(er,{fallback:ea(),children:["dashboard"===o&&(0,t.jsxs)("div",{className:"min-h-screen bg-background",children:[(0,t.jsxs)("div",{className:"max-w-md mx-auto bg-card shadow-2xl min-h-screen border-x border-border",children:[(0,t.jsxs)("div",{className:"bg-gradient-to-r from-card to-muted text-foreground p-6 rounded-b-lg border-b border-border",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"KSWiFi"}),(0,t.jsxs)("p",{className:"text-muted-foreground",children:["Welcome, ",L.name.split(" ")[0]]})]}),(0,t.jsxs)("div",{className:"flex space-x-2",children:[(0,t.jsx)(i.$,{variant:"ghost",size:"sm",onClick:()=>m("settings"),className:"text-muted-foreground hover:bg-muted/50 hover:text-foreground",children:(0,t.jsx)(ec.A,{className:"w-5 h-5"})}),(0,t.jsx)(i.$,{variant:"ghost",size:"sm",onClick:Q,className:"text-muted-foreground hover:bg-muted/50 hover:text-foreground",children:(0,t.jsx)(ed.A,{className:"w-5 h-5"})})]})]}),(0,t.jsx)(h,{isConnected:L.isWifiConnected,networkName:L.networkName})]}),(0,t.jsx)("div",{className:"p-6",children:(0,t.jsx)(l,{currentData:L.currentData,totalData:L.totalData,unit:"GB"})}),(0,t.jsxs)("div",{className:"px-6 pb-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsx)(f,{icon:k.A,label:"Download Session",description:"On WiFi",onClick:()=>{if(!L.isWifiConnected){V("warning","WiFi Required","Connect to WiFi to download internet sessions");return}if(!e){V("warning","Sign In Required","Please sign in to download sessions");return}M(!0)}}),(0,t.jsx)(f,{icon:$.A,label:"Activate Data Pack",description:"Use Downloaded",onClick:H})]}),(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsx)(f,{icon:Z.A,label:"Setup eSIM",description:"Scan QR Code",onClick:()=>V("info","QR Scanner","QR scanner feature coming soon!"),variant:"secondary"})})]}),(0,t.jsxs)("div",{className:"px-6 pb-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-foreground",children:"Recent Activity"}),(0,t.jsxs)(i.$,{variant:"ghost",size:"sm",className:"text-muted-foreground hover:text-foreground",children:[(0,t.jsx)(en.A,{className:"w-4 h-4 mr-1"}),"View All"]})]}),(0,t.jsx)("div",{className:"space-y-3",children:J.slice(0,3).map((e,s)=>(0,t.jsx)(j,{...e},s))})]}),(0,t.jsx)("div",{className:"px-6 pb-6",children:(0,t.jsx)(G,{refreshTrigger:W})})]}),E&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:(0,t.jsxs)("div",{className:"bg-background rounded-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,t.jsxs)("div",{className:"p-4 border-b border-border flex justify-between items-center",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-foreground",children:"Download Internet Session"}),(0,t.jsx)(i.$,{variant:"ghost",size:"sm",onClick:()=>M(!1),className:"text-muted-foreground hover:text-foreground",children:"✕"})]}),(0,t.jsx)("div",{className:"p-4",children:(0,t.jsx)(T,{onSessionDownload:e=>{M(!1),O(e=>e+1),P.oR.success("Session download started!",{description:"Your internet session is being prepared"})}})})]})}),g&&(0,t.jsx)(S,{onSelect:Y,onCancel:()=>p(!1)}),b.isVisible&&(0,t.jsx)(v,{type:b.type,title:b.title,message:b.message,isVisible:b.isVisible,onClose:()=>w(e=>({...e,isVisible:!1}))})]}),"settings"===o&&(0,t.jsx)("div",{className:"min-h-screen bg-background",children:(0,t.jsxs)("div",{className:"max-w-md mx-auto bg-card shadow-2xl min-h-screen border-x border-border",children:[(0,t.jsx)("div",{className:"bg-gradient-to-r from-primary to-kswifi-cyan-dark text-primary-foreground p-6 rounded-b-3xl",children:(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)(i.$,{variant:"ghost",size:"sm",onClick:()=>m("dashboard"),className:"text-primary-foreground hover:bg-black/20",children:"←"}),(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"Settings"})]})}),(0,t.jsxs)("div",{className:"p-6 space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-semibold mb-4 text-foreground",children:"Profile"}),(0,t.jsx)("div",{className:"space-y-3",children:(0,t.jsx)("div",{className:"flex items-center justify-between p-3 bg-muted/20 border border-border rounded-lg",children:(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(eo.A,{className:"w-5 h-5 text-primary"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-foreground",children:L.name}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:L.email})]})]})})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-semibold mb-4 text-foreground",children:"Security"}),(0,t.jsx)("div",{className:"space-y-3",children:(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 bg-muted/20 border border-border rounded-lg",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)(q.A,{className:"w-5 h-5 text-primary"}),(0,t.jsx)("span",{className:"text-foreground",children:"Enhanced Security"})]}),(0,t.jsx)(i.$,{variant:"outline",size:"sm",onClick:()=>y(!N),className:"border-border text-foreground hover:bg-muted",children:N?"Enabled":"Enable"})]})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-semibold mb-4 text-foreground",children:"Support"}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)(i.$,{variant:"ghost",className:"w-full justify-start p-3 text-foreground hover:bg-muted",children:[(0,t.jsx)(ei.A,{className:"w-5 h-5 mr-3 text-primary"}),"Help Center"]}),(0,t.jsxs)(i.$,{variant:"ghost",className:"w-full justify-start p-3 text-foreground hover:bg-muted",children:[(0,t.jsx)(el.A,{className:"w-5 h-5 mr-3 text-primary"}),"About KSWiFi"]})]})]}),(0,t.jsx)("div",{className:"pt-6 border-t border-border",children:(0,t.jsxs)(i.$,{variant:"destructive",className:"w-full bg-destructive text-destructive-foreground hover:bg-destructive/90",onClick:Q,children:[(0,t.jsx)(ed.A,{className:"w-4 h-4 mr-2"}),"Sign Out"]})})]})]})})]}):"onboarding"!==o||"signup"===u||"reset-password"===u?ea():(0,t.jsx)("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:(0,t.jsxs)(n.Zp,{className:"w-full max-w-md text-center p-8 bg-card border-border",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("div",{className:"w-20 h-20 bg-primary rounded-full flex items-center justify-center mx-auto mb-4 animate-pulse-cyan",children:(0,t.jsx)(z.A,{className:"w-10 h-10 text-primary-foreground"})}),(0,t.jsx)("h1",{className:"text-3xl font-bold text-foreground mb-2",children:"KSWiFi"}),(0,t.jsx)("p",{className:"text-muted-foreground mb-6",children:"Virtual eSIM Data Manager"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Download internet sessions on WiFi, use offline via eSIM"})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)(i.$,{className:"w-full bg-primary text-primary-foreground hover:bg-primary/90",size:"lg",onClick:()=>{x("signup"),m("dashboard")},children:"Get Started"}),(0,t.jsx)(i.$,{variant:"outline",className:"w-full border-border text-foreground hover:bg-muted",size:"lg",onClick:()=>{x("signin"),m("dashboard")},children:"Sign In"})]})]})})}},6942:(e,s,a)=>{Promise.resolve().then(a.bind(a,398))}},e=>{var s=s=>e(e.s=s);e.O(0,[96,333,358],()=>s(6942)),_N_E=e.O()}]);