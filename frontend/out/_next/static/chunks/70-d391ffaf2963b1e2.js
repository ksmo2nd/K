"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[70],{2770:(e,r,s)=>{s.d(r,{J:()=>o});var t=s(3365);s(1521);var a=s(8757),n=s(9671);function o(e){let{className:r,...s}=e;return(0,t.jsx)(a.b,{"data-slot":"label",className:(0,n.cn)("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",r),...s})}},4428:(e,r,s)=>{s.d(r,{A:()=>l,AuthProvider:()=>d});var t=s(3365),a=s(1521),n=s(8299),o=s(4089);let i=(0,a.createContext)(void 0);function d(e){let{children:r}=e,[s,d]=(0,a.useState)(null),[l,c]=(0,a.useState)(null),[u,h]=(0,a.useState)(!0);(0,a.useEffect)(()=>{(async()=>{let{data:{session:e},error:r}=await n.N.auth.getSession();if(r)console.error("Error getting session:",r);else{var s;c(e),d(null!==(s=null==e?void 0:e.user)&&void 0!==s?s:null)}h(!1)})();let{data:{subscription:e}}=n.N.auth.onAuthStateChange(async(e,r)=>{var s,t,a;console.log("Auth state changed:",e,null==r?void 0:null===(s=r.user)||void 0===s?void 0:s.email),c(r),d(null!==(t=null==r?void 0:r.user)&&void 0!==t?t:null),h(!1),"SIGNED_IN"===e?console.log("User signed in:",null==r?void 0:null===(a=r.user)||void 0===a?void 0:a.email):"SIGNED_OUT"===e?console.log("User signed out"):"TOKEN_REFRESHED"===e?console.log("Token refreshed"):"USER_UPDATED"===e?console.log("User updated"):"PASSWORD_RECOVERY"===e&&console.log("Password recovery initiated")});return()=>{e.unsubscribe()}},[]);let m=async(e,r,s)=>{try{let{data:t,error:a}=await n.N.auth.signUp({email:e,password:r,options:{data:s}});if(a)throw a;if(t.user&&s){let{error:e}=await n.N.from("users").insert({id:t.user.id,email:t.user.email,first_name:s.first_name,last_name:s.last_name,phone_number:s.phone_number,status:"active",is_admin:!1});e&&console.error("Profile creation error:",e);try{await fetch("".concat(o.env.NEXT_PUBLIC_BACKEND_URL||"http://localhost:8000","/api/auth/webhook/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:t.user.id})})}catch(e){console.warn("Backend signup webhook failed:",e)}}return{data:t,error:null}}catch(e){return console.error("Signup error:",e),{data:null,error:e}}},p=async(e,r)=>{try{let{data:s,error:t}=await n.N.auth.signInWithPassword({email:e,password:r});if(t)throw t;if(s.user)try{await fetch("".concat(o.env.NEXT_PUBLIC_BACKEND_URL||"http://localhost:8000","/api/auth/webhook/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:s.user.id})})}catch(e){console.warn("Backend login webhook failed:",e)}return{data:s,error:null}}catch(e){return console.error("Signin error:",e),{data:null,error:e}}},x=async()=>{try{let{error:e}=await n.N.auth.signOut();if(e)throw e}catch(e){throw console.error("Signout error:",e),e}},g=async e=>{try{let{data:r,error:s}=await n.N.auth.resetPasswordForEmail(e,{redirectTo:"".concat(window.location.origin,"/reset-password")});if(s)throw s;return{data:r,error:null}}catch(e){return console.error("Password reset error:",e),{data:null,error:e}}},w=async e=>{try{let{data:r,error:s}=await n.N.auth.updateUser({password:e});if(s)throw s;return{data:r,error:null}}catch(e){return console.error("Password update error:",e),{data:null,error:e}}};return(0,t.jsx)(i.Provider,{value:{user:s,session:l,loading:u,signUp:m,signIn:p,signOut:x,resetPassword:g,updatePassword:w},children:r})}function l(){let e=(0,a.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},6070:(e,r,s)=>{s.d(r,{j:()=>g});var t=s(3365),a=s(1521),n=s(8600),o=s(7812),i=s(2770),d=s(6170),l=s(4428),c=s(1e3),u=s(2196),h=s(5842),m=s(3505),p=s(6309),x=s(3678);function g(e){let{onSuccess:r}=e,{updatePassword:s}=(0,l.A)(),[g,w]=(0,a.useState)({password:"",confirmPassword:""}),[f,v]=(0,a.useState)(!1),[b,y]=(0,a.useState)(!1),[N,j]=(0,a.useState)(!1),[P,_]=(0,a.useState)(null),[k,S]=(0,a.useState)(!1),A={length:g.password.length>=8,uppercase:/[A-Z]/.test(g.password),lowercase:/[a-z]/.test(g.password),number:/\d/.test(g.password),special:/[!@#$%^&*(),.?":{}|<>]/.test(g.password)},E=Object.values(A).every(Boolean),C=g.password===g.confirmPassword&&g.confirmPassword.length>0,O=async e=>{if(e.preventDefault(),j(!0),_(null),!E){_("Password does not meet requirements"),j(!1);return}if(!C){_("Passwords do not match"),j(!1);return}try{let{data:e,error:t}=await s(g.password);if(t)throw t;S(!0),setTimeout(()=>{null==r||r()},2e3)}catch(e){console.error("Password update error:",e),_(e.message||"Failed to update password. Please try again.")}finally{j(!1)}},U=(e,r)=>{w(s=>({...s,[e]:r})),_(null)},I=e=>{let{met:r,text:s}=e;return(0,t.jsxs)("div",{className:"flex items-center text-xs ".concat(r?"text-primary":"text-muted-foreground"),children:[r?(0,t.jsx)(c.A,{className:"h-3 w-3 mr-1"}):(0,t.jsx)(u.A,{className:"h-3 w-3 mr-1"}),s]})};return k?(0,t.jsx)(d.Zp,{className:"w-full max-w-md mx-auto bg-card border-border",children:(0,t.jsxs)(d.aR,{className:"text-center",children:[(0,t.jsx)("div",{className:"mx-auto mb-4 flex h-12 w-12 items-center justify-center rounded-full bg-primary/20",children:(0,t.jsx)(h.A,{className:"h-6 w-6 text-primary"})}),(0,t.jsx)(d.ZB,{className:"text-2xl font-bold text-foreground",children:"Password Updated"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Your password has been successfully updated. You will be redirected shortly."})]})}):(0,t.jsxs)(d.Zp,{className:"w-full max-w-md mx-auto bg-card border-border",children:[(0,t.jsxs)(d.aR,{className:"text-center",children:[(0,t.jsx)(d.ZB,{className:"text-2xl font-bold text-foreground",children:"Update Password"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Enter your new password"})]}),(0,t.jsxs)("form",{onSubmit:O,children:[(0,t.jsxs)(d.Wu,{className:"space-y-4",children:[P&&(0,t.jsx)("div",{className:"p-3 text-sm text-red-400 bg-red-900/20 border border-red-800 rounded-md",children:P}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(i.J,{htmlFor:"password",children:"New Password"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(o.p,{id:"password",type:f?"text":"password",placeholder:"Enter your new password",value:g.password,onChange:e=>U("password",e.target.value),required:!0,disabled:N,className:"pr-10"}),(0,t.jsx)(n.$,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>v(!f),disabled:N,children:f?(0,t.jsx)(m.A,{className:"h-4 w-4"}):(0,t.jsx)(p.A,{className:"h-4 w-4"})})]}),g.password&&(0,t.jsxs)("div",{className:"space-y-1 p-2 bg-gray-50 rounded",children:[(0,t.jsx)(I,{met:A.length,text:"At least 8 characters"}),(0,t.jsx)(I,{met:A.uppercase,text:"One uppercase letter"}),(0,t.jsx)(I,{met:A.lowercase,text:"One lowercase letter"}),(0,t.jsx)(I,{met:A.number,text:"One number"}),(0,t.jsx)(I,{met:A.special,text:"One special character"})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(i.J,{htmlFor:"confirmPassword",children:"Confirm New Password"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(o.p,{id:"confirmPassword",type:b?"text":"password",placeholder:"Confirm your new password",value:g.confirmPassword,onChange:e=>U("confirmPassword",e.target.value),required:!0,disabled:N,className:"pr-10"}),(0,t.jsx)(n.$,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>y(!b),disabled:N,children:b?(0,t.jsx)(m.A,{className:"h-4 w-4"}):(0,t.jsx)(p.A,{className:"h-4 w-4"})})]}),g.confirmPassword&&(0,t.jsx)("div",{className:"text-xs ".concat(C?"text-green-600":"text-red-600"),children:C?(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(c.A,{className:"h-3 w-3 mr-1"}),"Passwords match"]}):(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(u.A,{className:"h-3 w-3 mr-1"}),"Passwords do not match"]})})]})]}),(0,t.jsx)(d.wL,{children:(0,t.jsx)(n.$,{type:"submit",className:"w-full",disabled:N||!E||!C,children:N?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Updating Password..."]}):"Update Password"})})]})]})}},6170:(e,r,s)=>{s.d(r,{Wu:()=>d,ZB:()=>i,Zp:()=>n,aR:()=>o,wL:()=>l});var t=s(3365);s(1521);var a=s(9671);function n(e){let{className:r,...s}=e;return(0,t.jsx)("div",{"data-slot":"card",className:(0,a.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",r),...s})}function o(e){let{className:r,...s}=e;return(0,t.jsx)("div",{"data-slot":"card-header",className:(0,a.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",r),...s})}function i(e){let{className:r,...s}=e;return(0,t.jsx)("div",{"data-slot":"card-title",className:(0,a.cn)("leading-none font-semibold",r),...s})}function d(e){let{className:r,...s}=e;return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,a.cn)("px-6",r),...s})}function l(e){let{className:r,...s}=e;return(0,t.jsx)("div",{"data-slot":"card-footer",className:(0,a.cn)("flex items-center px-6 [.border-t]:pt-6",r),...s})}},7812:(e,r,s)=>{s.d(r,{p:()=>n});var t=s(3365);s(1521);var a=s(9671);function n(e){let{className:r,type:s,...n}=e;return(0,t.jsx)("input",{type:s,"data-slot":"input",className:(0,a.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",r),...n})}},8299:(e,r,s)=>{s.d(r,{N:()=>t});let t=(0,s(7990).UU)("http://localhost:54321","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZS1kZW1vIiwicm9sZSI6ImFub24iLCJleHAiOjE5ODM4MTI5OTZ9.CRXP1A7WOeoJeXxjNni43kdQwgnWNReilDMblYTn_I0")},8600:(e,r,s)=>{s.d(r,{$:()=>d});var t=s(3365);s(1521);var a=s(9884),n=s(2934),o=s(9671);let i=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function d(e){let{className:r,variant:s,size:n,asChild:d=!1,...l}=e,c=d?a.DX:"button";return(0,t.jsx)(c,{"data-slot":"button",className:(0,o.cn)(i({variant:s,size:n,className:r})),...l})}},9671:(e,r,s)=>{s.d(r,{cn:()=>n});var t=s(4584),a=s(2292);function n(){for(var e=arguments.length,r=Array(e),s=0;s<e;s++)r[s]=arguments[s];return(0,a.QP)((0,t.$)(r))}}}]);