(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{357:e=>{e.exports={style:{fontFamily:"'GeistMono', ui-monospace, SFMono-Regular, Roboto Mono, Menlo, Monaco, Liberation Mono, DejaVu Sans Mono, Courier New, monospace"},className:"__className_f910ec",variable:"__variable_f910ec"}},2430:(e,t,r)=>{Promise.resolve().then(r.bind(r,9118)),Promise.resolve().then(r.bind(r,4428)),Promise.resolve().then(r.t.bind(r,2605,23)),Promise.resolve().then(r.t.bind(r,357,23)),Promise.resolve().then(r.t.bind(r,4270,23))},2605:e=>{e.exports={style:{fontFamily:"'GeistSans', 'GeistSans Fallback'"},className:"__className_fb8f2c",variable:"__variable_fb8f2c"}},4270:()=>{},4428:(e,t,r)=>{"use strict";r.d(t,{A:()=>u,AuthProvider:()=>l});var o=r(3365),n=r(1521),a=r(8299),s=r(4089);let i=(0,n.createContext)(void 0);function l(e){let{children:t}=e,[r,l]=(0,n.useState)(null),[u,c]=(0,n.useState)(null),[d,h]=(0,n.useState)(!0);(0,n.useEffect)(()=>{(async()=>{let{data:{session:e},error:t}=await a.N.auth.getSession();if(t)console.error("Error getting session:",t);else{var r;c(e),l(null!==(r=null==e?void 0:e.user)&&void 0!==r?r:null)}h(!1)})();let{data:{subscription:e}}=a.N.auth.onAuthStateChange(async(e,t)=>{var r,o,n;console.log("Auth state changed:",e,null==t?void 0:null===(r=t.user)||void 0===r?void 0:r.email),c(t),l(null!==(o=null==t?void 0:t.user)&&void 0!==o?o:null),h(!1),"SIGNED_IN"===e?console.log("User signed in:",null==t?void 0:null===(n=t.user)||void 0===n?void 0:n.email):"SIGNED_OUT"===e?console.log("User signed out"):"TOKEN_REFRESHED"===e?console.log("Token refreshed"):"USER_UPDATED"===e?console.log("User updated"):"PASSWORD_RECOVERY"===e&&console.log("Password recovery initiated")});return()=>{e.unsubscribe()}},[]);let m=async(e,t,r)=>{try{let{data:o,error:n}=await a.N.auth.signUp({email:e,password:t,options:{data:r}});if(n)throw n;if(o.user&&r){let{error:e}=await a.N.from("users").insert({id:o.user.id,email:o.user.email,first_name:r.first_name,last_name:r.last_name,phone_number:r.phone_number,status:"active",is_admin:!1});e&&console.error("Profile creation error:",e);try{await fetch("".concat(s.env.NEXT_PUBLIC_BACKEND_URL||"http://localhost:8000","/api/auth/webhook/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:o.user.id})})}catch(e){console.warn("Backend signup webhook failed:",e)}}return{data:o,error:null}}catch(e){return console.error("Signup error:",e),{data:null,error:e}}},p=async(e,t)=>{try{let{data:r,error:o}=await a.N.auth.signInWithPassword({email:e,password:t});if(o)throw o;if(r.user)try{await fetch("".concat(s.env.NEXT_PUBLIC_BACKEND_URL||"http://localhost:8000","/api/auth/webhook/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:r.user.id})})}catch(e){console.warn("Backend login webhook failed:",e)}return{data:r,error:null}}catch(e){return console.error("Signin error:",e),{data:null,error:e}}},v=async()=>{try{let{error:e}=await a.N.auth.signOut();if(e)throw e}catch(e){throw console.error("Signout error:",e),e}},w=async e=>{try{let{data:t,error:r}=await a.N.auth.resetPasswordForEmail(e,{redirectTo:"".concat(window.location.origin,"/reset-password")});if(r)throw r;return{data:t,error:null}}catch(e){return console.error("Password reset error:",e),{data:null,error:e}}},_=async e=>{try{let{data:t,error:r}=await a.N.auth.updateUser({password:e});if(r)throw r;return{data:t,error:null}}catch(e){return console.error("Password update error:",e),{data:null,error:e}}};return(0,o.jsx)(i.Provider,{value:{user:r,session:u,loading:d,signUp:m,signIn:p,signOut:v,resetPassword:w,updatePassword:_},children:t})}function u(){let e=(0,n.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},8299:(e,t,r)=>{"use strict";r.d(t,{N:()=>o});let o=(0,r(7990).UU)("http://localhost:54321","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZS1kZW1vIiwicm9sZSI6ImFub24iLCJleHAiOjE5ODM4MTI5OTZ9.CRXP1A7WOeoJeXxjNni43kdQwgnWNReilDMblYTn_I0")},9118:(e,t,r)=>{"use strict";r.d(t,{Toaster:()=>p});var o=r(3365),n=r(1521),a="(prefers-color-scheme: dark)",s=n.createContext(void 0),i={setTheme:e=>{},themes:[]},l=()=>{var e;return null!=(e=n.useContext(s))?e:i},u=null,c=(e,t)=>{let r;try{r=localStorage.getItem(e)||void 0}catch(e){}return r||t},d=e=>{let t=document.createElement("style");return e&&t.setAttribute("nonce",e),t.appendChild(document.createTextNode("*,*::before,*::after{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),document.head.appendChild(t),()=>{window.getComputedStyle(document.body),setTimeout(()=>{document.head.removeChild(t)},1)}},h=e=>(e||(e=window.matchMedia(a)),e.matches?"dark":"light"),m=r(1971);let p=e=>{let{...t}=e,{theme:r="system"}=l();return(0,o.jsx)(m.l$,{theme:r,className:"toaster group",style:{"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)"},...t})}}},e=>{var t=t=>e(e.s=t);e.O(0,[119,990,971,347,870,358],()=>t(2430)),_N_E=e.O()}]);